# CalTrack Monthly Gross Savings Estimation Technical Guidelines

=======

### Methodological Overview

Site-level Gross Savings using Monthly Billing Data (both electricity and gas) will use a two-stage estimation approach that closely follows the technical appendix of the Uniform Methods Project for Whole Home Building Analysis and the California Evaluation Project, while providing more specific guidance to ensure replicability.

The two-stage approach fits two separate parametric models to daily energy use data in both the pre-intervention (baseline) period and the post-intervention (reporting) period using the following first stage equation:

### First Stage Equation

![equation](http://latex.codecogs.com/gif.latex?E_%7Bim%7D%20%3D%20%5Cmu_i%20&plus;%5Cbeta_H*H_%7Bim%7D%28%5Ctau_H%29&plus;%5Cbeta_C*C_%7Bim%7D%28%5Ctau_C%29&plus;%5Cepsilon_%7Bim%7D)

In the second stage, using parameter estimates from the first stage, weather normalized savings for both the baseline period and reporting period can be computed by using corresponding temperature normals for the relevant time period (typical year weather normalized gross savings), or by using current-year weather to project forward baseline period use (current year weather normalized gross savings) and differencing between baseline and reporting period estimated use.  


### Technical guidelines for implementing two-stage estimation 

Monthly usage data used in the CalTrack Beta Test monthly analysis will be generated by rolling up hourly usage to the calendar month.

In order to ensure replicability of results, the following steps to two-stage modeling need clear and consistent rules:

1. Normalizing monthly readings to Use Per Day (UPD) using calendar month
2. Selecting balance point temperature search for calculating Heating Degree Days (*HDD*) and Cooling Degree Days (*CDD*) for each month.
3. Selecting parameters for inclusion in final site level savings estimation (model selection)


#### Normalizing Monthly Usage Data to Use Per Day

`monthly_usage_quantity / (calendar_month_end_date - calendar_month_start_date)`

#### Selecting balance point tempuratures for HDD and CDD

Balance point temperatures will be selected by doing a search over the two parameter HDD and CDD model separately using the following grid search criteria:

Search range for HDD base: `55 degrees F to 70 degrees F`
Search range for CDD base: `65 degrees F to 75 degrees F`

Grid search step size: `5 degrees`

Objective function: `min -R^2`

If `R^2 < .05` after search, the base temperature should default to **60 F** for heating and **70 F** for cooling.


#### Model selection

For each site, the choice must be made between using one of of the single parameter models (Just `HDD` or `CDD`) or combined `HDD` and `CDD` models. This choice is called *model selection*. For CalTrack, model selection will be done by sequential model fit in the following way:

1. Fit combined `HDD` + `CDD` model.
2. If parameter estimates for combined model all meet minimum stignificance criteria (`p < 0.1` for both parameters) then the combined model is used. 
3. If one or more of the parameters do not meet the significance criteria, perform an F-test between the combined and the HDD model to ensure multicolinearity isn't causing individual insignificance by joint significance. 
4. If it fails the F-test, then default to the single parameter model where the parameter estimate meets the significance test. 
5. If neither the HDD nor the CDD parameters meet the significance test, but the intercept does, use only the intercept (weather independent usage mean for the time period) as the site-level model. 

### Second Stage Estimated Quantities
During the second stage, three savings quantities will be estimated for each site.

1. Cumulative gross savings over entire performance period
2. Normal year annualized gross savings
3. Current year annualized gross savings in current year

## Prepared Summary Statistics for Analysis Comparison

To ensure that the CalTrack analysis specification can produce consistent results, each beta tester will generate a set of summary statistics on each of the above site-level savings estimates that can be shared with the larger group through csvs saved to this repository. There will be one savings summary file generated by each Beta Tester. Each file will be a .csv and will have the following general format:

| Summary Stat | Value |
| --- | --- |
| Number of Sites Included in Analysis | 4321 |
| Number of sites that met model fitnes criteria | 3800 |
| Min cumulative gross savings | 123 |
| Max cumulative gross savings| 456| 



### Combined Project Data Summary File

**Output Filename: `monthly_billing_analysis_savings_summary_NAME_OF_TESTER.csv`**


#### Included Summary statistics

- Total number of sites included in first-stage estimation
- Total number of sites with cumulative gross savings estimates
- Total number of sites with normal year annualized gross savings 
- Total number of sites with current year annualized gross savings 
- Min cumulative gross savings
- Max cumulative gross savings
- Average cumulative gross savings
- 10th percentile value cumulative gross savings
- 20th percentile value cumulative gross savings
- 30th percentile value cumulative gross savings
- 40th percentile value cumulative gross savings
- 50th percentile value cumulative gross savings
- 60th percentile value cumulative gross savings
- 70th percentile value cumulative gross savings
- 80th percentile value cumulative gross savings
- 90th percentile value cumulative gross savings
- Min normal year annualized savings
- Max normal year annualized savings
- Average normal year annualized savings
- 10th percentile value normal year annualized savings 
- 20th percentile value normal year annualized savings
- 30th percentile value normal year annualized savings
- 40th percentile value normal year annualized savings
- 50th percentile value normal year annualized savings
- 60th percentile value normal year annualized savings
- 70th percentile value normal year annualized savings
- 80th percentile value normal year annualized savings
- 90th percentile value normal year annualized savings
- Min current year annualized gross savings
- Max current year annualized gross savings
- Average current year annualized gross savings
- 10th percentile value current year annualized gross savings
- 20th percentile value current year annualized gross savings
- 30th percentile value current year annualized gross savings
- 40th percentile value current year annualized gross savings
- 50th percentile value current year annualized gross savings
- 60th percentile value current year annualized gross savings
- 70th percentile value current year annualized gross savings
- 80th percentile value current year annualized gross savings
- 90th percentile value current year annualized gross savings
